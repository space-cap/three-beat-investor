"삼박자 투자법" 종목 발굴기 - 작업 계획서

1. 프로젝트 개요

목표: '삼박자 투자법'의 가치/가격 필터링을 KIS API의 '종목조건검색' 기능으로 자동화하는 Python 스크립트 개발.

제약: requests 표준 라이브러리 사용 (래퍼 미사용), KisClient 클래스 기반 객체 지향 구현.

2. Phase 1: 환경 설정 및 인증 (D+0 ~ D+1)

2.1. 작업 내용

프로젝트 구조 생성:

three_beat_investor/ 루트 폴더 생성.

src/, tests/ 하위 폴더 생성.

__init__.py 파일 생성 (Python 패키지 인식).

가상 환경 설정:

python -m venv venv

source venv/bin/activate (또는 Windows: venv\Scripts\activate)

의존성 파일 작성 (requirements.txt):

requests

python-dotenv

pytest

pytest-mock (모킹을 위해 unittest.mock 대신 사용 가능)

설정 파일 준비:

.gitignore 파일 생성 (Python, venv, .env 등 추가).

.env.example 파일 생성 (필요한 환경 변수 명시).

KIS API 인증 구현 (src/kis_client.py):

KisClient 클래스 기본 구조 작성.

__init__ 메서드 구현 (URL 설정 로직 포함).

_get_token 메서드 구현 (requests.post 사용).

2.2. 산출물

프로젝트 폴더 구조.

requirements.txt, .env.example, .gitignore.

토큰 발급 기능이 구현된 src/kis_client.py의 초기 버전.

2.3. 검증

tests/test_kis_client.py 작성 시작.

requests.post를 모킹(mocking)하여 _get_token이 정상 동작하는지 단위 테스트 작성.

3. Phase 2: 핵심 API 기능 구현 (D+2 ~ D+3)

3.1. 작업 내용

토큰 관리 로직 구현 (src/kis_client.py):

_check_token 메서드 구현 (토큰 만료 시간 비교 로직).

헤더 생성기 구현 (src/kis_client.py):

_get_headers 메서드 구현.

'종목조건검색' API 연동 (src/kis_client.py):

fetch_conditional_search 메서드 구현.

requests.get을 사용하여 FHPST01710000 API 호출.

params (CUST_ID, COND_KEY, SEQ) 정확히 설정.

응답(JSON) 파싱하여 output (종목 코드 리스트) 추출.

오류 처리:

requests 예외 처리 (ConnectionError, Timeout 등).

KIS API 응답 (rt_cd != '0') 오류 처리 로직 추가.

3.2. 산출물

핵심 기능이 완성된 src/kis_client.py.

3.3. 검증

test_fetch_conditional_search_mocked 테스트 케이스 작성 (requests.get 모킹).

모의투자 환경에서 실제 API 호출 테스트 (환경 변수 설정 후).

4. Phase 3: 실행 스크립트 및 완료 (D+4)

4.1. 작업 내용

실행 스크립트 작성 (src/main.py):

.env 파일에서 설정값 로드.

KisClient 인스턴스화.

fetch_conditional_search 호출 및 결과 출력.

try...except로 main 함수 전체를 감싸 사용자 친화적 오류 메시지 출력.

문서화:

코드 내 주석 상세히 추가 (요청 사항).

README.md 파일 작성 (프로젝트 개요, 설정 방법, 실행 방법 명시).

최종 테스트:

전체 단위 테스트(pytest) 실행.

실제 모의투자 환경에서 python src/main.py 실행하여 종단간(E2E) 테스트.

3.2. 산출물

src/main.py (실행 파일).

README.md (사용자 가이드).

상세한 주석이 달린 전체 소스 코드.

3.3. 검증

python src/main.py 실행 시 HTS에서 설정한 조건 검색식과 동일한 종목 리스트가 출력됨.